<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH5824 Generalised Linear and Additive Models - 2&nbsp; Introducing Splines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./3_interpolating.html" rel="next">
<link href="./1_introduction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="webex.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./2_basicdefinitions.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducing Splines</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MATH5824 Generalised Linear and Additive Models</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weekly schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0_preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Non-parametric Modelling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_basicdefinitions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducing Splines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_interpolating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interpolating Splines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_smoothing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Smoothing Splines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_smoothingparameter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Choosing the Smoothing Parameter</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_smoothinginpractice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">General Additive Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-definitions" id="toc-basic-definitions" class="nav-link active" data-scroll-target="#basic-definitions"><span class="header-section-number">2.1</span> Basic definitions</a></li>
  <li><a href="#focus-on-splines-quiz" id="toc-focus-on-splines-quiz" class="nav-link" data-scroll-target="#focus-on-splines-quiz">Focus on splines quiz</a></li>
  <li><a href="#imposing-smoothness" id="toc-imposing-smoothness" class="nav-link" data-scroll-target="#imposing-smoothness"><span class="header-section-number">2.2</span> Imposing smoothness</a></li>
  <li><a href="#focus-on-smoothness-quiz" id="toc-focus-on-smoothness-quiz" class="nav-link" data-scroll-target="#focus-on-smoothness-quiz">Focus on smoothness quiz</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">2.3</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-basicdefinitions" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introducing Splines</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="hidden">
<p><span class="math display">\[
\def\b#1{\mathbf{#1}}
\]</span></p>
</div>
<section id="basic-definitions" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="basic-definitions"><span class="header-section-number">2.1</span> Basic definitions</h2>
<p>Let <span class="math inline">\(t_1 &lt; t_2 &lt; \ldots &lt; t_m\)</span> be a fixed set of <em>sites</em> or <em>knots</em> which need not correspond to observation locations, as in <a href="#fig-knots">Figure&nbsp;<span>2.1</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-knots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2_basicdefinitions_files/figure-html/fig-knots-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2.1: Diagram of knots and data points.</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that we use the symbol <span class="math inline">\(t\)</span>, rather than <span class="math inline">\(x\)</span>, so that we do not confuse knots and observation locations.</p>
<p>A spline of order <span class="math inline">\(p\geq 1\)</span> is a piecewise-polynomial of order <span class="math inline">\(p\)</span> which is <span class="math inline">\((p-1)\)</span> times differentiable at the knots. Thus there are coefficients <span class="math inline">\(\{a_{k\ell},\; k=0,\ldots,m, \; \ell=0,\ldots,p\}\)</span> such that <span id="eq-spline"><span class="math display">\[
f(t) = \sum_{\ell=0}^p a_{k\ell} \; t^\ell,\qquad \text{for}~t_k \leq t &lt;t_{k+1},
\tag{2.1}\]</span></span> where we take <span class="math inline">\(t_0 = -\infty\)</span> and <span class="math inline">\(t_{m+1} = +\infty\)</span>.</p>
<p>If we are using cubic polynomials, (<span class="math inline">\(p=3\)</span>), then <span class="math inline">\(f\)</span> is given by the following equations: <span class="math display">\[
f(t) = a_{00} + a_{01} t + a_{02}t^2 +a_{03}t^3, \quad
t_0 \le t &lt; t_1
\]</span> to the left of the first knot, <span class="math display">\[
f(t) = a_{10} + a_{11} t + a_{12}t^2 +a_{13}t^3, \quad
t_1 \le t &lt; t_2
\]</span> between the first and second knots, and so on until <span class="math display">\[
f(t) = a_{m0} + a_{m1} t + a_{m2}t^2 +a_{m3}t^3, \quad
t_m \le t &lt; t_{m+1}
\]</span> to the right of the final knot. This is illustrated in <a href="#fig-piecewise-cubic-1">Figure&nbsp;<span>2.2 (a)</span></a> with <span class="math inline">\(m=2.\)</span></p>
<div id="fig-piecewise-cubic" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-piecewise-cubic-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2_basicdefinitions_files/figure-html/fig-piecewise-cubic-1.png" class="img-fluid figure-img" data-ref-parent="fig-piecewise-cubic" width="672"></p>
<figcaption class="figure-caption">(a) No smoothness constraints</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-piecewise-cubic-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="2_basicdefinitions_files/figure-html/fig-piecewise-cubic-2.png" class="img-fluid figure-img" data-ref-parent="fig-piecewise-cubic" width="672"></p>
<figcaption class="figure-caption">(b) With smoothness constraints</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.2: Piecewise-cubic functions in three intervals with knot positions indicated with vertical lines.</figcaption><p></p>
</figure>
</div>
</section>
<section id="focus-on-splines-quiz" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="focus-on-splines-quiz">Focus on splines quiz</h2>
<p>Test your knowledge recall and comprehension to reinforce basic ideas about splines.</p>
<div class="webex-box">
<div class="webex-check">
<ol type="1">
<li><p>Which of the following best describes the relationship between knots and data locations.</p>
<div id="radio_GINJJEFGMN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GINJJEFGMN" value=""> <span>Knots are the response and data locations are the explanatory variable</span></label><label><input type="radio" autocomplete="off" name="radio_GINJJEFGMN" value=""> <span>There must be fewer knots than data locations</span></label><label><input type="radio" autocomplete="off" name="radio_GINJJEFGMN" value="answer"> <span>Knots and data locations are both marked on the x-axis</span></label><label><input type="radio" autocomplete="off" name="radio_GINJJEFGMN" value=""> <span>Knots and data points are exactly the same</span></label>
</div></li>
<li><p>How many polynomial equations are need to define a cubic spline with four knots? <select class="webex-select"><option value="blank"></option><option value="">3</option><option value="">4</option><option value="answer">5</option><option value="">12</option><option value="">None of the above</option></select></p></li>
<li><p>What is the highest power possible in a cubic spline? <select class="webex-select"><option value="blank"></option><option value="">0</option><option value="">1</option><option value="">2</option><option value="answer">3</option><option value="">None of the above</option></select></p></li>
<li><p>How many times can a spline of order 5 be differentiated at the knots? <select class="webex-select"><option value="blank"></option><option value="">Cannot be differentiated</option><option value="">Twice differentiable</option><option value="answer">Four times differentiable</option><option value="">Infinitly differentiable</option></select></p></li>
<li><p>Which of the following is NOT a property of cubic splines? <select class="webex-select"><option value="blank"></option><option value="">Piecewise cubic polynomial</option><option value="">Twice differentiable</option><option value="answer">May contain change-points</option><option value="">Continuous at the knots</option></select></p></li>
</ol>
</div>
</div>
</section>
<section id="imposing-smoothness" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="imposing-smoothness"><span class="header-section-number">2.2</span> Imposing smoothness</h2>
<p>Because of the use of polynomials, <span class="math inline">\(f\)</span> is smooth <em>between</em> each successive pair of knots. At the knots, however, <span class="math inline">\(f\)</span> might not be continuous and it might not be differentiable – in such cases we would say that the function is not smooth.</p>
<p>To ensure that <span class="math inline">\(f\)</span> is also smooth at each of the knots, we impose smoothness constraints which control continuity of the function and its derivatives at the knots.</p>
<p>Let <span class="math inline">\(f^{(\ell)}\)</span> be the <span class="math inline">\(\ell\)</span>-th order derivative, with <span class="math inline">\(f^{(0)}=f\)</span> being the function itself, <span class="math inline">\(f^{(1)}=f'\)</span> is the first derivative and <span class="math inline">\(f^{(2)}=f''\)</span> the second derivative. Further, let <span class="math inline">\(f^{(\ell)}(t-\epsilon)\)</span> and <span class="math inline">\(f^{(\ell)}(t+\epsilon)\)</span>, for <span class="math inline">\(\epsilon\ge 0\)</span>, denote evaluation of the function or its derivative at points just below and just above <span class="math inline">\(t\)</span> – we will be interested in their relative values as <span class="math inline">\(\epsilon \rightarrow 0\)</span>.</p>
<p>To impose smoothness, we require that</p>
<p><span id="eq-smoothcons"><span class="math display">\[
\lim _{\epsilon\rightarrow 0} f^{(\ell)}(t_k-\epsilon)
=
\lim _{\epsilon\rightarrow 0} f^{(\ell)}(t_k+\epsilon),
\tag{2.2}\]</span></span> for all <span class="math inline">\(k=1,\ldots,m\)</span> and for <span class="math inline">\(\ell = 0,\ldots,(p-1)\)</span>.</p>
<p>In other words we say that <span class="math inline">\(f\)</span> is smooth if the limits, from below and from above, of the function and its <span class="math inline">\((p-1)\)</span> derivatives exist and are equal.</p>
<p>The meaning of these smoothness constraints is illustrated in <a href="#fig-piecewise-cubic">Figure&nbsp;<span>2.2</span></a>. In <a href="#fig-piecewise-cubic-1">Figure&nbsp;<span>2.2 (a)</span></a>, a piecewise cubic function with two knots has been plotted. The first derivative, <span class="math inline">\(f'\)</span>, is discontinuous at the first knot and the function itself, <span class="math inline">\(f\)</span>, is discontinuous at the second knot. <a href="#fig-piecewise-cubic-2">Figure&nbsp;<span>2.2 (b)</span></a> shows a similar shaped cubic spline with two knots. This time, the function <span class="math inline">\(f\)</span> and its first two derivatives are continuous at both knots.</p>
<p>The smoothness conditions in <a href="#eq-smoothcons">Equation&nbsp;<span>2.2</span></a> induce constraints on the coefficients <span class="math inline">\(\{a_{k\ell}\}\)</span>. A polynomial of order <span class="math inline">\(p\)</span> has <span class="math inline">\(p+1\)</span> coefficients, and there are <span class="math inline">\(m+1\)</span> intervals when we have <span class="math inline">\(m\)</span> knots. This leads to <span class="math inline">\((p+1)\times(m+1)\)</span> coefficients but there are <span class="math inline">\(p\)</span> constraints at each of the <span class="math inline">\(m\)</span> knots. Thus the total <em>degrees of freedom</em> of the system is <span id="eq-df"><span class="math display">\[
\text{df}_{\text{spline}}   = (p+1)(m+1) - pm = m+p+1.
\tag{2.3}\]</span></span></p>
<p>These degrees of freedom provide the necessary flexibility in the spline.</p>
<p>Note that <span class="math inline">\(f\)</span> is infinitely differentiable everywhere, except at the knots where it is <span class="math inline">\(p-1\)</span> times differentiable. In particular, for <span class="math inline">\(p=1\)</span>, <span class="math inline">\(f\)</span> is a linear spline comprising linear pieces constrained to be continuous at the knots, although the slope of <span class="math inline">\(f\)</span> is discontinuous at the knots. Also, for <span class="math inline">\(p=3\)</span>, <span class="math inline">\(f\)</span> is a cubic spline comprising cubic polynomial pieces continuous at the knots; where the first and second derivatives of <span class="math inline">\(f\)</span> are also continuous, but the third derivative is discontinuous at the knots.</p>
</section>
<section id="focus-on-smoothness-quiz" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="focus-on-smoothness-quiz">Focus on smoothness quiz</h2>
<p>Test your knowledge recall and comprehension to reinforce basic ideas about smoothness.</p>
<div class="webex-box">
<div class="webex-check">
<ol type="1">
<li><p>Which of the following best describes the motivation for using smooth fitted models? <select class="webex-select"><option value="blank"></option><option value="">Makes model fitting easier</option><option value="">Calculations are easy to do in R</option><option value="">It produces nice graphs</option><option value="answer">Reduces the effect of measurement error</option><option value="">None of the above</option></select></p></li>
<li><p>Which of the following best describes the motivation for using piecewise polynomial components? <select class="webex-select"><option value="blank"></option><option value="">Can involve change-points</option><option value="answer">Well understood and easy to use</option><option value="">Can model jumps well</option><option value="">They lead to normally distributed errors</option><option value="">None of the above</option></select></p></li>
<li><p>Is the following a true statement? ‘The higher the order of the polynomial components the smoother the spline’ <select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></p></li>
<li><p>If a model fitted to a particular data set has zero degrees of freedom, then which of the following statements about the solution is most likely to be true? <select class="webex-select"><option value="blank"></option><option value="">Does not fit the data well</option><option value="">No solution</option><option value="answer">Unique solution</option><option value="">Multiple solutions</option></select></p></li>
<li><p>Which of the following best describes spline modeling? <select class="webex-select"><option value="blank"></option><option value="">The only non-parametric method available</option><option value="">It is a parametric approach</option><option value="">Requires high-level coding</option><option value="answer">A flexible non-parametric approach</option></select></p></li>
</ol>
</div>
</div>
</section>
<section id="exercises" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="exercises"><span class="header-section-number">2.3</span> Exercises</h2>
<div class="webex-box">
2.1 Why is it not sensible to define a smooth function made-up of constant components? Similarly, why is not sensible to create a differentiable function from linear splines?
<div class="webex-solution">
<button>
Click here to see hints.
</button>
<p>For each case, think about the number of parameters for each component and the implications of any constraints.</p>
</div>
2.2 In the situation illustrated in <a href="#fig-piecewise-cubic-2">Figure&nbsp;<span>2.2 (b)</span></a>, where <span class="math inline">\(p=3\)</span> and <span class="math inline">\(m=2\)</span>, clearly identify the <span class="math inline">\((p+1)\times (m+1)=12\)</span> model parameters and the <span class="math inline">\(pm=6\)</span> smoothness constraints in terms of the cubic polynomials and their derivatives.
<div class="webex-solution">
<button>
Click here to see hints.
</button>
<p>Define a cubic polynomial for each interval and consider continuity and differentiability.</p>
</div>
2.3 Further consider the situation illustrated in <a href="#fig-piecewise-cubic-2">Figure&nbsp;<span>2.2 (b)</span></a>. Suppose now that we require the splines to pass through specified coordinates <span class="math inline">\((t_1, f(t_1))\)</span> and <span class="math inline">\((t_2, f(t_2))\)</span>. What is the degrees of freedom for this model? How many such cubic splines would satisfy these constraints? Discuss potential additional constraints which would lead to a unique fitted model. Do you think having a unique solution is a positive or negative property?
<div class="webex-solution">
<button>
Click here to see hints.
</button>
<p>Think about the degrees of freedom, that is the total number of parameters and the number of constraints, including forcing the spine to pass through two points. Think about the implications of having zero and non-zero degrees of freedom. There are very many (infinitely many?) potential additional constraints, but suggest one or two which sound a good idea.</p>
</div>
2.4 For a general problem, what would be the effect of requiring additional constraints of the form of <a href="#eq-smoothcons">Equation&nbsp;<span>2.2</span></a> but with <span class="math inline">\(\ell = p\)</span>? Would this lead to an acceptable fitted cubic spline model? Justify your answer.
<div class="webex-solution">
<button>
Click here to see hints.
</button>
<p>Think about the implication of this on the curvature of neighbouring components, and hence on overall curvature.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://rgaykroyd.github.io/MATH5824/Solutions_2.html">Exercise 2 Solutions can be found here.</a></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1_introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Non-parametric Modelling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./3_interpolating.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Interpolating Splines</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>